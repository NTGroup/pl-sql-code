
<!DOCTYPE html><html><head><meta charset="utf-8"><title>hello-backbonejs</title></head><body>                                                                                                                                                                                                                                                                                                                   <hr><h1>blng.fwdr
</h1>                                                                                                                                                                                                                                                                                                                                                                                          <br><br><br><i>function
</i>                                                                                                                                                                                                                                                                                                                                                                                     <b>get_tenant
</b><br>                                                                                                                                                                                                                                                                                                                                                                                           <i>description:</i><br>return tenant. tenant is contract identifire. tenant using 
<br>                                                                                                                                                                                                                                                                                                                          <i>description:</i><br>for checking is client registered in the system.
<br>                                                                                                                                                                                                                                                                                                                                     <i>parameters:</i><br><b>p_email:</b> user email
</b><br>                                                                                                                                                                                                                                                                                                                                                        <i>return:</i><br>contract identifire
<br>                                                                                                                                                                                                                                                                                                                                                                       <br><br><br><i>function
</i>                                                                                                                                                                                                                                                                                                                                                                                     <b>company_insteadof_client
</b><br>                                                                                                                                                                                                                                                                                                                                                                             <i>description:</i><br>return id of client with max id across company
<br>                                                                                                                                                                                                                                                                                                                                       <i>parameters:</i><br><b>p_company:</b> company id where we looking for client
</b><br>                                                                                                                                                                                                                                                                                                                          <i>return:</i><br>client id
<br>                                                                                                                                                                                                                                                                                                                                                                                 <br><br><br><i>function
</i>                                                                                                                                                                                                                                                                                                                                                                                     <b>balance
</b><br>                                                                                                                                                                                                                                                                                                                                                                                              <i>description:</i><br>return info of contract for show balance to the client
<br>                                                                                                                                                                                                                                                                                                                               <i>parameters:</i><br><b>P_TENANT_ID:</b> contract id
</b><br>                                                                                                                                                                                                                                                                                                                                                   <i>return:</i><br>SYS_REFCURSOR[CONTRACT_OID, DEPOSIT, LOAN, CREDIT_LIMIT, UNUSED_CREDIT_LIMIT, 
<br>                                                                                                                                                                                                                                                                                                            <i>return:</i><br>AVAILABLE, BLOCK_DATE, UNBLOCK_SUM, NEAR_UNBLOCK_SUM, EXPIRY_DATE, EXPIRY_SUM]
<br>                                                                                                                                                                                                                                                                                                            <br><br><br><i>function
</i>                                                                                                                                                                                                                                                                                                                                                                                     <b>whoami
</b><br>                                                                                                                                                                                                                                                                                                                                                                                               <i>description:</i><br>return info for user
<br>                                                                                                                                                                                                                                                                                                                                                                 <i>parameters:</i><br><b>p_user:</b> email
</b><br>                                                                                                                                                                                                                                                                                                                                                              <i>return:</i><br>SYS_REFCURSOR[CLIENT_ID, LAST_NAME, FIRST_NAME, EMAIL, PHONE, --TENANT_ID, 
<br>                                                                                                                                                                                                                                                                                                               <i>return:</i><br>BIRTH_DATE, GENDER, NATIONALITY, NLS_NATIONALITY, DOC_ID, DOC_EXPIRY_DATE, 
<br>                                                                                                                                                                                                                                                                                                               <i>return:</i><br>DOC_NUMBER, DOC_LAST_NAME, DOC_FIRST_NAME, DOC_OWNER, DOC_GENDER, 
<br>                                                                                                                                                                                                                                                                                                                        <i>return:</i><br>DOC_BIRTH_DATE, DOC_NATIONALITY, DOC_NLS_NATIONALITY, DOC_PHONE, COMPANY_NAME,is_tester]
<br>                                                                                                                                                                                                                                                                                                  <br><br><br><i>function
</i>                                                                                                                                                                                                                                                                                                                                                                                     <b>client_data_edit
</b><br>                                                                                                                                                                                                                                                                                                                                                                                     <i>description:</i><br>update client documents. if success return true else false
<br>                                                                                                                                                                                                                                                                                                                           <i>parameters:</i><br><b>p_data:</b> data for update. format json[email, first_name, last_name, 
</b><br>                                                                                                                                                                                                                                                                                                        <i>parameters:</i><br><b>p_data:</b> gender, birth_date, nationality, phone, docs[doc_expiry_date, 
</b><br>                                                                                                                                                                                                                                                                                                     <i>parameters:</i><br><b>p_data:</b> doc_gender, doc_first_name, doc_last_name, doc_number, doc_owner, 
</b><br>                                                                                                                                                                                                                                                                                                 <i>parameters:</i><br><b>p_data:</b> doc_id, doc_nationality, doc_birth_date,doc_phone]]
</b><br>                                                                                                                                                                                                                                                                                                                <i>return:</i><br>SYS_REFCURSOR[res:true/false]
<br>                                                                                                                                                                                                                                                                                                                                                             <br><br><br><i>function
</i>                                                                                                                                                                                                                                                                                                                                                                                     <b>statement
</b><br>                                                                                                                                                                                                                                                                                                                                                                                            <i>description:</i><br>return list of transactions between dates in client timezone format
<br>                                                                                                                                                                                                                                                                                                                  <i>parameters:</i><br><b>p_email:</b> user email which request statement
</b><br>                                                                                                                                                                                                                                                                                                                                <i>parameters:</i><br><b>p_row_count:</b> count rows per page
</b><br>                                                                                                                                                                                                                                                                                                                                           <i>parameters:</i><br><b>p_page_number:</b> page number to show
</b><br>                                                                                                                                                                                                                                                                                                                                         <i>parameters:</i><br><b>p_date_from:</b> date filter.
</b><br>                                                                                                                                                                                                                                                                                                                                                  <i>parameters:</i><br><b>p_date_to:</b> date filter.
</b><br>                                                                                                                                                                                                                                                                                                                                                    <i>return:</i><br>SYS_REFCURSOR[rn(row_number),all v_statemen filds + amount_cash_in,amount_buy,amount_from,amount_to,page_count,row_count]
<br>                                                                                                                                                                                                                                                                 <br><br><br><i>function
</i>                                                                                                                                                                                                                                                                                                                                                                                     <b>statement
</b><br>                                                                                                                                                                                                                                                                                                                                                                                            <i>description:</i><br>return list of transactions in client timezone format by pages
<br>                                                                                                                                                                                                                                                                                                                       <i>parameters:</i><br><b>p_email:</b> user email which request statement
</b><br>                                                                                                                                                                                                                                                                                                                                <i>parameters:</i><br><b>p_row_count:</b> count rows per page
</b><br>                                                                                                                                                                                                                                                                                                                                           <i>parameters:</i><br><b>p_page_number:</b> page number to show
</b><br>                                                                                                                                                                                                                                                                                                                                         <i>return:</i><br>SYS_REFCURSOR[rn(row_number),all v_statemen filds + amount_cash_in,amount_buy,amount_from,amount_to,page_count,row_count]
<br>                                                                                                                                                                                                                                                                 <br><br><br><i>function
</i>                                                                                                                                                                                                                                                                                                                                                                                     <b>loan_list
</b><br>                                                                                                                                                                                                                                                                                                                                                                                            <i>description:</i><br>return list of loans with expired flag
<br>                                                                                                                                                                                                                                                                                                                                               <i>parameters:</i><br><b>p_email:</b> user email who request loan_list
</b><br>                                                                                                                                                                                                                                                                                                                                  <i>parameters:</i><br><b>p_rownum:</b> cuts rows for paging
</b><br>                                                                                                                                                                                                                                                                                                                                             <i>return:</i><br>SYS_REFCURSOR[ID, CONTRACT_OID, AMOUNT, ORDER_NUMBER, PNR_ID, DATE_TO, IS_OVERDUE]
<br>                                                                                                                                                                                                                                                                                                        <br><br><br><i>function
</i>                                                                                                                                                                                                                                                                                                                                                                                     <b>v_account_get_info_r
</b><br>                                                                                                                                                                                                                                                                                                                                                                                 <i>description:</i><br>return all fields from blng.v_account
<br>                                                                                                                                                                                                                                                                                                                                                <i>parameters:</i><br><b>p_contract:</b> contract id
</b><br>                                                                                                                                                                                                                                                                                                                                                    <i>return:</i><br>SYS_REFCURSOR[all v_statemen fields]
<br>                                                                                                                                                                                                                                                                                                                                                      <br><br><br><i>function
</i>                                                                                                                                                                                                                                                                                                                                                                                     <b>contract_get
</b><br>                                                                                                                                                                                                                                                                                                                                                                                         <i>description:</i><br>return list of contract with company
<br>                                                                                                                                                                                                                                                                                                                                                 <i>parameters:</i><br><b>p_contract:</b> contract id
</b><br>                                                                                                                                                                                                                                                                                                                                                    <i>return:</i><br>SYS_REFCURSOR[COMPANY_ID, CONTRACT_ID, COMPANY_NAME, CONTRACT_NUMBER]
<br>                                                                                                                                                                                                                                                                                                                     <br><br><br><i>function
</i>                                                                                                                                                                                                                                                                                                                                                                                     <b>check_tenant
</b><br>                                                                                                                                                                                                                                                                                                                                                                                         <i>description:</i><br>return tenant. tenant is contract identifire. tenant using 
<br>                                                                                                                                                                                                                                                                                                                          <i>description:</i><br>for checking is client registered in the system. if user dosnt exist then return NULL
<br>                                                                                                                                                                                                                                                                                                <i>parameters:</i><br><b>p_email:</b> user email
</b><br>                                                                                                                                                                                                                                                                                                                                                        <i>return:</i><br>contract identifire
<br>                                                                                                                                                                                                                                                                                                                                                                       <br><br><br><i>procedure
</i>                                                                                                                                                                                                                                                                                                                                                                                    <b>god_unblock
</b><br>                                                                                                                                                                                                                                                                                                                                                                                          <i>description:</i><br>unblock user god@ntg-one.com. this user must be usually at blocked status [C]losed
<br>                                                                                                                                                                                                                                                                                                   <br><br><br><i>procedure
</i>                                                                                                                                                                                                                                                                                                                                                                                    <b>god_block
</b><br>                                                                                                                                                                                                                                                                                                                                                                                            <i>description:</i><br>block user god@ntg-one.com. this user must be usually at blocked status [C]losed
<br>                                                                                                                                                                                                                                                                                                     <br><br><br><i>procedure
</i>                                                                                                                                                                                                                                                                                                                                                                                    <b>god_move
</b><br>                                                                                                                                                                                                                                                                                                                                                                                             <i>description:</i><br>move user god@ntg-one.com to contract with id equals p_tenant. 
<br>                                                                                                                                                                                                                                                                                                                      <i>description:</i><br>mission of god@ntg-one.com is to login under one of a contract and check errors.
<br>                                                                                                                                                                                                                                                                                                     <i>description:</i><br>god can help others to understand some problems 
<br>                                                                                                                                                                                                                                                                                                                                     <i>parameters:</i><br><b>p_tenant:</b> id of contract
</b><br>                                                                                                                                                                                                                                                                                                                                                   <br><br><br><i>constant
</i>                                                                                                                                                                                                                                                                                                                                                                                     <b>g_delay_days
</b><br>                                                                                                                                                                                                                                                                                                                                                                                         <i>description:</i><br>means how many days client has for pay loan
<br>                                                                                                                                                                                                                                                                                                                                          <br><br><br><i>procedure
</i>                                                                                                                                                                                                                                                                                                                                                                                    <b>approve_documents
</b><br>                                                                                                                                                                                                                                                                                                                                                                                    <i>description:</i><br>calls from scheduler. get list of document and separate it by transaction type.
<br>                                                                                                                                                                                                                                                                                                      <i>description:</i><br>documents like increase credit limit or loan days approve immediately
<br>                                                                                                                                                                                                                                                                                                                <i>description:</i><br>docs like cash_in/buy push to credit/debit_online accounts.
<br>                                                                                                                                                                                                                                                                                                                          <br><br><br><i>procedure
</i>                                                                                                                                                                                                                                                                                                                                                                                    <b>buy
</b><br>                                                                                                                                                                                                                                                                                                                                                                                                  <i>description:</i><br>calls inside approve_documents and push buy documents to debit_online account
<br>                                                                                                                                                                                                                                                                                                        <i>parameters:</i><br><b>p_doc:</b> id of document
</b><br>                                                                                                                                                                                                                                                                                                                                                      <br><br><br><i>procedure
</i>                                                                                                                                                                                                                                                                                                                                                                                    <b>cash_in
</b><br>                                                                                                                                                                                                                                                                                                                                                                                              <i>description:</i><br>calls inside approve_documents and push cash_in documents to credit_online account
<br>                                                                                                                                                                                                                                                                                                   <i>parameters:</i><br><b>p_doc:</b> row from document
</b><br>                                                                                                                                                                                                                                                                                                                                                   <br><br><br><i>procedure
</i>                                                                                                                                                                                                                                                                                                                                                                                    <b>pay_bill
</b><br>                                                                                                                                                                                                                                                                                                                                                                                             <i>description:</i><br>procedure make paing for one bill
<br>                                                                                                                                                                                                                                                                                                                                                    <i>parameters:</i><br><b>p_doc:</b> row from document
</b><br>                                                                                                                                                                                                                                                                                                                                                   <br><br><br><i>procedure
</i>                                                                                                                                                                                                                                                                                                                                                                                    <b>credit_online
</b><br>                                                                                                                                                                                                                                                                                                                                                                                        <i>description:</i><br>calls from scheduler. get list of credit_online accounts and separate money to debit or loan accounts.
<br>                                                                                                                                                                                                                                                                               <i>description:</i><br>then close loan delay
<br>                                                                                                                                                                                                                                                                                                                                                                <br><br><br><i>procedure
</i>                                                                                                                                                                                                                                                                                                                                                                                    <b>debit_online
</b><br>                                                                                                                                                                                                                                                                                                                                                                                         <i>description:</i><br>calls from scheduler. get list of debit_online accounts and separate money to debit or loan accounts.
<br>                                                                                                                                                                                                                                                                                <i>description:</i><br>then create loan delay
<br>                                                                                                                                                                                                                                                                                                                                                               <br><br><br><i>procedure
</i>                                                                                                                                                                                                                                                                                                                                                                                    <b>online
</b><br>                                                                                                                                                                                                                                                                                                                                                                                               <i>description:</i><br>calls from scheduler debit_online and credit_online procedures.
<br>                                                                                                                                                                                                                                                                                                                      <i>description:</i><br>then create loan delay
<br>                                                                                                                                                                                                                                                                                                                                                               <br><br><br><i>procedure
</i>                                                                                                                                                                                                                                                                                                                                                                                    <b>delay_remove
</b><br>                                                                                                                                                                                                                                                                                                                                                                                         <i>description:</i><br>calls from credit_online and close loan delay
<br>                                                                                                                                                                                                                                                                                                                                        <i>parameters:</i><br><b>p_contract:</b> id of contract
</b><br>                                                                                                                                                                                                                                                                                                                                                 <i>parameters:</i><br><b>p_amount:</b> how much money falls to delay list
</b><br>                                                                                                                                                                                                                                                                                                                               <i>parameters:</i><br><b>p_transaction:</b> link to transaction id. later by this id cash_in operations may revokes
</b><br>                                                                                                                                                                                                                                                                                     <br><br><br><i>procedure
</i>                                                                                                                                                                                                                                                                                                                                                                                    <b>delay_expire
</b><br>                                                                                                                                                                                                                                                                                                                                                                                         <i>description:</i><br>calls from scheduler at 00:00 UTC. get list of expired delays, then block credit limit
<br>                                                                                                                                                                                                                                                                                               <br><br><br><i>procedure
</i>                                                                                                                                                                                                                                                                                                                                                                                    <b>contract_unblock
</b><br>                                                                                                                                                                                                                                                                                                                                                                                     <i>description:</i><br>calls by office user and give chance to pay smth for p_days. 
<br>                                                                                                                                                                                                                                                                                                                        <i>description:</i><br>due to this days expired contract have unblocked credit limit. 
<br>                                                                                                                                                                                                                                                                                                                      <i>description:</i><br>after p_days it blocks again
<br>                                                                                                                                                                                                                                                                                                                                                         <i>parameters:</i><br><b>p_contract:</b> id of expired contract
</b><br>                                                                                                                                                                                                                                                                                                                                         <i>parameters:</i><br><b>p_days:</b> how much days gifted to client
</b><br>                                                                                                                                                                                                                                                                                                                                     <br><br><br><i>procedure
</i>                                                                                                                                                                                                                                                                                                                                                                                    <b>unblock
</b><br>                                                                                                                                                                                                                                                                                                                                                                                              <i>description:</i><br>check if contract do not have expired delays and unblock it
<br>                                                                                                                                                                                                                                                                                                                          <i>parameters:</i><br><b>p_contract:</b> id of expired contract
</b><br>                                                                                                                                                                                                                                                                                                                                         <br><br><br><i>procedure
</i>                                                                                                                                                                                                                                                                                                                                                                                    <b>revoke_document
</b><br>                                                                                                                                                                                                                                                                                                                                                                                      <i>description:</i><br>get back money and erase transactions by p_document id
<br>                                                                                                                                                                                                                                                                                                                               <i>parameters:</i><br><b>p_document:</b> id of document
</b><br>                                                                                                                                                                                                                                                                                                                                                 <br><br><br><i>function
</i>                                                                                                                                                                                                                                                                                                                                                                                     <b>pay_contract_by_client
</b><br>                                                                                                                                                                                                                                                                                                                                                                               <i>description:</i><br>get contract which client can spend money 
<br>                                                                                                                                                                                                                                                                                                                                           <i>description:</i><br>documents like increase credit limit or loan days approve immediately
<br>                                                                                                                                                                                                                                                                                                                <i>description:</i><br>docs like buy or cash_in push to credit/debit_online accounts.
<br>                                                                                                                                                                                                                                                                                                                       <i>parameters:</i><br><b>p_client:</b> client id
</b><br>                                                                                                                                                                                                                                                                                                                                                        <i>return:</i><br>contract id
<br>                                                                                                                                                                                                                                                                                                                                                                               <hr><h1>BLNG.BLNG_API 
</h1>                                                                                                                                                                                                                                                                                                                                                                                     <i>description:</i><br>***_add insert row into table ***. could return id of new row.
<br>                                                                                                                                                                                                                                                                                                                       <i>description:</i><br>***_edit update row into table ***. object have always one id. first, old data with amnd_state = [I]nactive
<br>                                                                                                                                                                                                                                                                          <i>description:</i><br>inserted as row with link to new row(amnd_prev). new data just update object row, 
<br>                                                                                                                                                                                                                                                                                                   <i>description:</i><br>amnd_date updates to sysdate and amnd_user to current user who called api.
<br>                                                                                                                                                                                                                                                                                                           <i>description:</i><br>***_get_info return data from table *** with format SYS_REFCURSOR.
<br>                                                                                                                                                                                                                                                                                                                   <i>description:</i><br>***_get_info_r return one row from table *** with format ***%rowtype.
<br>                                                                                                                                                                                                                                                                                                                <br><br><br><i>procedure
</i>                                                                                                                                                                                                                                                                                                                                                                                    <b>account_init
</b><br>                                                                                                                                                                                                                                                                                                                                                                                         <i>description:</i><br>create all accounts under the contract
<br>                                                                                                                                                                                                                                                                                                                                               <i>parameters:</i><br><b>p_contract:</b> contract id
</b><br>                                                                                                                                                                                                                                                                                                                                                    <hr><h1>ORD.ORD_API
</h1>                                                                                                                                                                                                                                                                                                                                                                                        <i>description:</i><br>***_add insert row into table ***. could return id of new row.
<br>                                                                                                                                                                                                                                                                                                                       <i>description:</i><br>***_edit update row into table ***. object have always one id. first, old data with amnd_state = [I]nactive
<br>                                                                                                                                                                                                                                                                          <i>description:</i><br>inserted as row with link to new row(amnd_prev). new data just update object row, 
<br>                                                                                                                                                                                                                                                                                                   <i>description:</i><br>amnd_date updates to sysdate and amnd_user to current user who called api.
<br>                                                                                                                                                                                                                                                                                                           <i>description:</i><br>***_get_info return data from table *** with format SYS_REFCURSOR.
<br>                                                                                                                                                                                                                                                                                                                   <i>description:</i><br>***_get_info_r return one row from table *** with format ***%rowtype.
<br>                                                                                                                                                                                                                                                                                                                <br><br><br><i>function
</i>                                                                                                                                                                                                                                                                                                                                                                                     <b>order_create
</b><br>                                                                                                                                                                                                                                                                                                                                                                                         <i>description:</i><br>fake function. used in avia_register for creating emty order
<br>                                                                                                                                                                                                                                                                                                                         <i>parameters:</i><br><b>p_date:</b> date for wich we need create order
</b><br>                                                                                                                                                                                                                                                                                                                                 <i>parameters:</i><br><b>p_order_number:</b> number could set or generate inside
</b><br>                                                                                                                                                                                                                                                                                                                        <i>parameters:</i><br><b>p_status:</b> status like 'W' waiting or smth else 
</b><br>                                                                                                                                                                                                                                                                                                                            <i>return:</i><br>id of created order
<br>                                                                                                                                                                                                                                                                                                                                                                       <br><br><br><i>function
</i>                                                                                                                                                                                                                                                                                                                                                                                     <b>item_add
</b><br>                                                                                                                                                                                                                                                                                                                                                                                             <i>description:</i><br>fake function.
<br>                                                                                                                                                                                                                                                                                                                                                                       <i>return:</i><br>id of created item
<br>                                                                                                                                                                                                                                                                                                                                                                        <br><br><br><i>procedure
</i>                                                                                                                                                                                                                                                                                                                                                                                    <b>avia_update
</b><br>                                                                                                                                                                                                                                                                                                                                                                                          <i>description:</i><br>procedure update item_avia row searched by pnr_id.
<br>                                                                                                                                                                                                                                                                                                                                   <i>parameters:</i><br><b>p_pnr_id:</b> id from NQT. search perform by this id
</b><br>                                                                                                                                                                                                                                                                                                                           <i>parameters:</i><br><b>p_pnr_locator:</b> record locator just for info
</b><br>                                                                                                                                                                                                                                                                                                                                <i>parameters:</i><br><b>p_time_limit:</b> time limit just for info
</b><br>                                                                                                                                                                                                                                                                                                                                     <i>parameters:</i><br><b>p_total_amount:</b> total amount including markup
</b><br>                                                                                                                                                                                                                                                                                                                              <i>parameters:</i><br><b>p_total_markup:</b> just total markup
</b><br>                                                                                                                                                                                                                                                                                                                                          <i>parameters:</i><br><b>p_pnr_object:</b> json for backup
</b><br>                                                                                                                                                                                                                                                                                                                                              <i>parameters:</i><br><b>p_nqt_status:</b> current NQT process
</b><br>                                                                                                                                                                                                                                                                                                                                          <i>parameters:</i><br><b>p_tenant_id:</b> id of contract in text format, for authorization
</b><br>                                                                                                                                                                                                                                                                                                              <br><br><br><i>procedure
</i>                                                                                                                                                                                                                                                                                                                                                                                    <b>avia_reg_ticket
</b><br>                                                                                                                                                                                                                                                                                                                                                                                      <i>description:</i><br>procedure get ticket info by pnr_id.
<br>                                                                                                                                                                                                                                                                                                                                                 <i>description:</i><br>its create row for ticket. later this info will send to managers
<br>                                                                                                                                                                                                                                                                                                                     <i>parameters:</i><br><b>p_pnr_id:</b> id from NQT. search perform by this id
</b><br>                                                                                                                                                                                                                                                                                                                           <i>parameters:</i><br><b>p_tenant_id:</b> id of contract in text format, for authorization
</b><br>                                                                                                                                                                                                                                                                                                              <i>parameters:</i><br><b>p_ticket:</b> json[p_number,p_name,p_fare_amount,p_tax_amount,p_markup_amount,p_type]
</b><br>                                                                                                                                                                                                                                                                                          <br><br><br><i>procedure
</i>                                                                                                                                                                                                                                                                                                                                                                                    <b>avia_pay
</b><br>                                                                                                                                                                                                                                                                                                                                                                                             <i>description:</i><br>procedure send all bills in status [M]arked to [W]aiting in billing for pay.
<br>                                                                                                                                                                                                                                                                                                         <i>parameters:</i><br><b>p_user_id:</b> user identifire. at this moment email
</b><br>                                                                                                                                                                                                                                                                                                                           <i>parameters:</i><br><b>p_pnr_id:</b> id from NQT. search perform by this id
</b><br>                                                                                                                                                                                                                                                                                                                           <br><br><br><i>function
</i>                                                                                                                                                                                                                                                                                                                                                                                     <b>order_get
</b><br>                                                                                                                                                                                                                                                                                                                                                                                            <i>description:</i><br>fake
<br>                                                                                                                                                                                                                                                                                                                                                                                 <br><br><br><i>function
</i>                                                                                                                                                                                                                                                                                                                                                                                     <b>item_list
</b><br>                                                                                                                                                                                                                                                                                                                                                                                            <i>description:</i><br>fake
<br>                                                                                                                                                                                                                                                                                                                                                                                 <br><br><br><i>function
</i>                                                                                                                                                                                                                                                                                                                                                                                     <b>item_list
</b><br>                                                                                                                                                                                                                                                                                                                                                                                            <i>description:</i><br>fake
<br>                                                                                                                                                                                                                                                                                                                                                                                 <br><br><br><i>function
</i>                                                                                                                                                                                                                                                                                                                                                                                     <b>pnr_list
</b><br>                                                                                                                                                                                                                                                                                                                                                                                             <i>description:</i><br>get pnr list whith statuses listed in p_nqt_status_list and with paging by p_rownum count.
<br>                                                                                                                                                                                                                                                                                           <i>parameters:</i><br><b>p_nqt_status_list:</b> json[status]
</b><br>                                                                                                                                                                                                                                                                                                                                            <i>parameters:</i><br><b>p_rownum:</b> filter for rows count
</b><br>                                                                                                                                                                                                                                                                                                                                            <i>return:</i><br>sys_refcursor[pnr_id, nqt_status, po_status, nqt_status_cur, null po_msg, 'avia' item_type, pnr_locator, tenant_id]
<br>                                                                                                                                                                                                                                                                       <br><br><br><i>function
</i>                                                                                                                                                                                                                                                                                                                                                                                     <b>pnr_list
</b><br>                                                                                                                                                                                                                                                                                                                                                                                             <i>description:</i><br>get pnr list whith id listed in p_pnr_list.
<br>                                                                                                                                                                                                                                                                                                                                          <i>parameters:</i><br><b>p_pnr_list:</b> json[p_pnr_id,p_tenant_id], where
</b><br>                                                                                                                                                                                                                                                                                                                              <i>parameters:</i><br><b>p_pnr_id:</b> id from NQT. search perform by this id
</b><br>                                                                                                                                                                                                                                                                                                                           <i>parameters:</i><br><b>p_tenant_id:</b> id of contract in text format, for authorization
</b><br>                                                                                                                                                                                                                                                                                                              <i>return:</i><br>sys_refcursor[pnr_id, nqt_status, po_status, nqt_status_cur, null po_msg, 'avia' item_type, pnr_locator,tenant_id]
<br>                                                                                                                                                                                                                                                                        <br><br><br><i>procedure
</i>                                                                                                                                                                                                                                                                                                                                                                                    <b>commission_get
</b><br>                                                                                                                                                                                                                                                                                                                                                                                       <i>description:</i><br>calculate commission for pnr_id
<br>                                                                                                                                                                                                                                                                                                                                                      <i>parameters:</i><br><b>p_pnr_id:</b> id from NQT. search perform by this id
</b><br>                                                                                                                                                                                                                                                                                                                           <i>parameters:</i><br><b>p_tenant_id:</b> id of contract in text format, for authorization
</b><br>                                                                                                                                                                                                                                                                                                              <i>parameters:</i><br><b>o_fix:</b> in this paraveter returned fix commission value
</b><br>                                                                                                                                                                                                                                                                                                                     <i>parameters:</i><br><b>o_percent:</b> in this paraveter returned percent commission value
</b><br>                                                                                                                                                                                                                                                                                                             <br><br><br><i>function
</i>                                                                                                                                                                                                                                                                                                                                                                                     <b>order_number_generate
</b><br>                                                                                                                                                                                                                                                                                                                                                                                <i>description:</i><br>generate order number as last number + 1 by client id
<br>                                                                                                                                                                                                                                                                                                                                <i>parameters:</i><br><b>p_client:</b> client id.
</b><br>                                                                                                                                                                                                                                                                                                                                                       <i>return:</i><br>string like 0012410032, where 1241 - client id and 32 is a counter of order
<br>                                                                                                                                                                                                                                                                                                               <br><br><br><i>procedure
</i>                                                                                                                                                                                                                                                                                                                                                                                    <b>avia_manual
</b><br>                                                                                                                                                                                                                                                                                                                                                                                          <i>description:</i><br>update order status to p_result[ERROR/SUCCESS] or to INPROGRESS, if ERROR then return all money.
<br>                                                                                                                                                                                                                                                                                     <i>parameters:</i><br><b>p_pnr_id:</b> id from NQT. search perform by this id
</b><br>                                                                                                                                                                                                                                                                                                                           <i>parameters:</i><br><b>p_tenant_id:</b> id of contract in text format, for authorization
</b><br>                                                                                                                                                                                                                                                                                                              <i>parameters:</i><br><b>p_result:</b> [ERROR/SUCCESS/ if null then INPROGRESS] 
</b><br>                                                                                                                                                                                                                                                                                                                        <br><br><br><i>procedure
</i>                                                                                                                                                                                                                                                                                                                                                                                    <b>cash_back
</b><br>                                                                                                                                                                                                                                                                                                                                                                                            <i>description:</i><br>perform reverse for order scheme. return bill to Waiting status
<br>                                                                                                                                                                                                                                                                                                                      <i>description:</i><br>and call revoke_document from billing
<br>                                                                                                                                                                                                                                                                                                                                                <i>parameters:</i><br><b>p_pnr_id:</b> id from NQT. search perform by this id
</b><br>                                                                                                                                                                                                                                                                                                                           <br><br><br><i>function
</i>                                                                                                                                                                                                                                                                                                                                                                                     <b>get_sales_list
</b><br>                                                                                                                                                                                                                                                                                                                                                                                       <i>description:</i><br>fake
<br>                                                                                                                                                                                                                                                                                                                                                                                 <br><br><br><i>function
</i>                                                                                                                                                                                                                                                                                                                                                                                     <b>rule_view
</b><br>                                                                                                                                                                                                                                                                                                                                                                                            <i>description:</i><br>return all rules by iata code of airline
<br>                                                                                                                                                                                                                                                                                                                                             <i>parameters:</i><br><b>p_iata:</b> iata 2 char code
</b><br>                                                                                                                                                                                                                                                                                                                                                   <i>return:</i><br>SYS_REFCURSOR[fields from v_rule view]
<br>                                                                                                                                                                                                                                                                                                                                                    <br><br><br><i>procedure
</i>                                                                                                                                                                                                                                                                                                                                                                                    <b>avia_create
</b><br>                                                                                                                                                                                                                                                                                                                                                                                          <i>description:</i><br>procedure create item_avia row only. it cant update item 
<br>                                                                                                                                                                                                                                                                                                                            <i>parameters:</i><br><b>p_pnr_id:</b> id from NQT. search perform by this id
</b><br>                                                                                                                                                                                                                                                                                                                           <i>parameters:</i><br><b>p_user_id:</b> user identifire. at this moment email
</b><br>                                                                                                                                                                                                                                                                                                                           <br><br><br><i>procedure
</i>                                                                                                                                                                                                                                                                                                                                                                                    <b>avia_booked
</b><br>                                                                                                                                                                                                                                                                                                                                                                                          <i>description:</i><br>procedure send item/order/bill to billing for pay.
<br>                                                                                                                                                                                                                                                                                                                                   <i>parameters:</i><br><b>p_pnr_id:</b> id from NQT. search perform by this id
</b><br>                                                                                                                                                                                                                                                                                                                           <i>parameters:</i><br><b>p_user_id:</b> user identifire. at this moment email
</b><br>                                                                                                                                                                                                                                                                                                                           <br><br><br><i>function
</i>                                                                                                                                                                                                                                                                                                                                                                                     <b>pos_rule_get
</b><br>                                                                                                                                                                                                                                                                                                                                                                                         <i>description:</i><br>when p_version is null then return all active rows. if not null then  
<br>                                                                                                                                                                                                                                                                                                               <i>description:</i><br>get all active and deleted rows that changed after p_version id
<br>                                                                                                                                                                                                                                                                                                                      <i>parameters:</i><br><b>p_version:</b> id
</b><br>                                                                                                                                                                                                                                                                                                                                                              <i>return:</i><br>SYS_REFCURSOR[ID, TENANT_ID, VALIDATING_CARRIER,booking_pos,ticketing_pos,stock,printer,VERSION, IS_ACTIVE]
<br>                                                                                                                                                                                                                                                                               <i>return:</i><br>default tenant_id = 0, default validating_carrier = 'YY'
<br>                                                                                                                                                                                                                                                                                                                                  <br><br><br><i>function
</i>                                                                                                                                                                                                                                                                                                                                                                                     <b>pos_rule_edit
</b><br>                                                                                                                                                                                                                                                                                                                                                                                        <i>description:</i><br>update pos_rules or create new pos_rules. if success return true else false.
<br>                                                                                                                                                                                                                                                                                                         <i>description:</i><br>if status equals [C]lose or [D]elete then delete pos_rule.
<br>                                                                                                                                                                                                                                                                                                                           <i>parameters:</i><br><b>p_data:</b> data for update. format json[id, tenant_id, validating_carrier, 
</b><br>                                                                                                                                                                                                                                                                                                   <i>parameters:</i><br><b>p_data:</b> booking_pos, ticketing_pos, stock, printer, status]
</b><br>                                                                                                                                                                                                                                                                                                                <i>return:</i><br>SYS_REFCURSOR[res:true/false]
<br>                                                                                                                                                                                                                                                                                                                                                             <br><br><br><i>function
</i>                                                                                                                                                                                                                                                                                                                                                                                     <b>rule_edit
</b><br>                                                                                                                                                                                                                                                                                                                                                                                            <i>description:</i><br>update commission rules or create new commission rules. if success return true else false.
<br>                                                                                                                                                                                                                                                                                           <i>description:</i><br>if status equals [C]lose or [D]elete then delete commission rule.
<br>                                                                                                                                                                                                                                                                                                                    <i>parameters:</i><br><b>p_data:</b> data for update. format json[AIRLINE_ID, CONTRACT_ID, RULE_ID, 
</b><br>                                                                                                                                                                                                                                                                                                    <i>parameters:</i><br><b>p_data:</b> RULE_DESCRIPTION, RULE_LIFE_FROM, RULE_LIFE_TO, RULE_AMOUNT, 
</b><br>                                                                                                                                                                                                                                                                                                      <i>parameters:</i><br><b>p_data:</b> RULE_AMOUNT_MEASURE, RULE_PRIORITY, CONDITION_ID,condition_status, TEMPLATE_TYPE_ID, 
</b><br>                                                                                                                                                                                                                                                                              <i>parameters:</i><br><b>p_data:</b> TEMPLATE_NAME_NLS, TEMPLATE_VALUE]
</b><br>                                                                                                                                                                                                                                                                                                                                 <i>return:</i><br>SYS_REFCURSOR[res:true/false]
<br>                                                                                                                                                                                                                                                                                                                                                             <br><br><br><i>function
</i>                                                                                                                                                                                                                                                                                                                                                                                     <b>rule_delete
</b><br>                                                                                                                                                                                                                                                                                                                                                                                          <i>description:</i><br>delete commission rule.
<br>                                                                                                                                                                                                                                                                                                                                                              <i>parameters:</i><br><b>p_id:</b> rule id
</b><br>                                                                                                                                                                                                                                                                                                                                                              <i>return:</i><br>SYS_REFCURSOR[res:true/false]
<br>                                                                                                                                                                                                                                                                                                                                                             <br><br><br><i>function
</i>                                                                                                                                                                                                                                                                                                                                                                                     <b>rule_template_list
</b><br>                                                                                                                                                                                                                                                                                                                                                                                   <i>description:</i><br>return all commission templates
<br>                                                                                                                                                                                                                                                                                                                                                      <i>parameters:</i><br><b>p_is_contract_type:</b> if 'Y' then return all contract_types else all template_types
</b><br>                                                                                                                                                                                                                                                                                          <i>return:</i><br>SYS_REFCURSOR[ID, TEMPLATE_TYPE, PRIORITY, DETAILS, IS_CONTRACT_TYPE, NAME, NLS_NAME, IS_VALUE]
<br>                                                                                                                                                                                                                                                                                           <br><br><br><i>function
</i>                                                                                                                                                                                                                                                                                                                                                                                     <b>bill_import_list
</b><br>                                                                                                                                                                                                                                                                                                                                                                                     <i>description:</i><br>return all bills info for import into 1C
<br>                                                                                                                                                                                                                                                                                                                                             <i>return:</i><br>SYS_REFCURSOR[BILL_OID, ITEM, IS_NDS, FLIGHT_FROM, FLIGHT_TO, FARE_AMOUNT, CONTRACT_NUMBER, PASSENGER_NAME]
<br>                                                                                                                                                                                                                                                                               <br><br><br><i>function
</i>                                                                                                                                                                                                                                                                                                                                                                                     <b>markup_rule_get
</b><br>                                                                                                                                                                                                                                                                                                                                                                                      <i>description:</i><br>return all markup rules
<br>                                                                                                                                                                                                                                                                                                                                                              <i>parameters:</i><br><b>p_version:</b> version id. filter new changes
</b><br>                                                                                                                                                                                                                                                                                                                                  <i>return:</i><br>SYS_REFCURSOR[ID, IS_ACTIVE, VERSION, TENANT_ID, IATA, MARKUP_TYPE, RULE_AMOUNT, RULE_AMOUNT_MEASURE, MIN_ABSOLUT, PRIORITY, PER_SEGMENT,CONTRACT_TYPE,CONDITION_COUNT]
<br>                                                                                                                                                                                                                   <br><br><br><i>function
</i>                                                                                                                                                                                                                                                                                                                                                                                     <b>markup_templ_get
</b><br>                                                                                                                                                                                                                                                                                                                                                                                     <i>description:</i><br>return all markup templates for rule id
<br>                                                                                                                                                                                                                                                                                                                                              <i>parameters:</i><br><b>p_rule_id:</b> id of rule
</b><br>                                                                                                                                                                                                                                                                                                                                                      <i>return:</i><br>SYS_REFCURSOR[ID, TEMPLATE_TYPE_CODE, TEMPLATE_VALUE]
<br>                                                                                                                                                                                                                                                                                                                                     <br><br><br><i>procedure
</i>                                                                                                                                                                                                                                                                                                                                                                                    <b>bill_pay
</b><br>                                                                                                                                                                                                                                                                                                                                                                                             <i>description:</i><br>procedure perform transit bills with status [W]aiting to billing system. 
<br>                                                                                                                                                                                                                                                                                                            <i>description:</i><br>that means bill requested for pay. after that bill marked as [T]ransported
<br>                                                                                                                                                                                                                                                                                                           <i>description:</i><br>this procedure executed from job scheduler
<br>                                                                                                                                                                                                                                                                                                                                           <br><br><br><i>procedure
</i>                                                                                                                                                                                                                                                                                                                                                                                    <b>doc_task_list
</b><br>                                                                                                                                                                                                                                                                                                                                                                                        <i>description:</i><br>procedure perform document tasks like pay for bills, set cledit limit and others money tasks. 
<br>                                                                                                                                                                                                                                                                                       <i>description:</i><br>main idea of function is to separate BUY process from others.
<br>                                                                                                                                                                                                                                                                                                                        <i>description:</i><br>this procedure executed from job scheduler
<br>                                                                                                                                                                                                                                                                                                                                           </body></html>                                                                                                                                                                                          
